generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Game {
  id           String   @id @default(cuid())
  tableId      Int      @unique @map("table_id")
  gameId       String   @default("1495") @map("game_id")
  gameName     String   @default("gaiaproject") @map("game_name")
  playerCount  Int      @map("player_count")
  winnerName   String   @map("winner_name")
  minPlayerElo Int?     @map("min_player_elo")
  rawGameLog   Json     @map("raw_game_log")
  players      Player[]

  @@index([winnerName])
  @@index([playerCount])
  @@index([minPlayerElo])
  @@map("games")
}

model Player {
  id            String  @id @default(cuid())
  tableId       Int     @map("table_id")
  playerId      Int     @map("player_id")
  playerName    String  @map("player_name")
  raceId        Int     @map("race_id")
  raceName      String  @map("race_name")
  finalScore    Int     @map("final_score")
  playerElo     Int?    @map("player_elo")
  isWinner      Boolean @default(false) @map("is_winner")
  buildingsData Json    @map("buildings_data")
  game          Game    @relation(fields: [tableId], references: [tableId], onDelete: Cascade)

  @@index([playerName])
  @@index([raceId])
  @@index([raceName])
  @@index([finalScore])
  @@index([playerElo])
  @@index([tableId])
  @@index([isWinner])
  @@index([raceId, finalScore])
  @@index([tableId, raceId])
  @@index([playerElo, finalScore])
  @@index([buildingsData], map: "players_buildings_data_gin_idx", type: Gin)
  @@map("players")
}
